# 配分表自动转换工具 v2.0

一个用户友好的桌面应用程序，可自动将配分表（Excel格式）转换为箱設定格式文件，大幅减少手动操作时间和错误。

## 功能特点

- ✅ **可视化界面**：简单直观的GUI操作，对小白友好
- ✅ **自动转换**：一键完成从配分表到箱設定的转换
- ✅ **智能分组**：根据SKU配比自动分类生成PT页
- ✅ **排序优化**：SKU按品番、カラー、サイズ从小到大自动排序
- ✅ **真正合并单元格** ⭐：使用openpyxl，完美支持Excel合并单元格
- ✅ **样式完美保留**：背景色、边框、字体格式100%保持
- ✅ **元数据提取**：自动提取管理No和店着日并写入对应位置
- ✅ **实时日志**：详细的转换过程日志，便于追踪和调试
- ✅ **错误提示**：清晰的错误信息，帮助快速定位问题
- ✅ **现代格式**：输出标准.xlsx文件，兼容所有现代Excel版本

## 安装

### 前提条件
- Python 3.7 或更高版本

#### [requirements.txt](file:///Users/Avis/Desktop/AutoPackage/requirements.txt)
Python依赖包列表
- xlrd：读取.xls文件（配分表）
- openpyxl：读写.xlsx文件（模板和输出）
- tkinter：GUI（Python内置，无需安装）

### 安装步骤

1. 打开终端，进入项目目录：
```bash
cd /Users/Avis/Desktop/AutoPackage
```

2. 安装依赖包：
```bash
python3 -m pip install -r requirements.txt
```

## 使用方法

### 启动应用

在终端中运行：
```bash
python3 main.py
```

### 操作步骤

1. **选择配分表文件**
   - 点击"浏览..."按钮
   - 选择需要转换的配分表Excel文件（.xls格式）

2. **选择模板文件**
   - 默认使用 `template.xls`
   - 如需使用其他模板，点击"浏览..."选择

3. **选择输出路径**
   - 点击"浏览..."按钮
   - 选择保存位置和文件名
   - 或者让程序自动生成输出文件名

4. **开始转换**
   - 点击"开始转换"按钮
   - 观察进度条和日志输出
   - 转换完成后会弹出提示框

## 业务规则

### 装箱规则
- 每个箱子包含同一店铺、同一タイプ的商品
- 每个店铺的每个タイプ分配唯一的箱号（CTN_NO）

### PT分组规则
- 根据店铺的SKU配比（数量组合）自动分组
- 所有SKU配货数量完全相同的店铺归为同一个PT
- 只要有一个颜色或尺码的数量不同，就生成不同的PT
- PT按发现顺序编号（PT-1, PT-2, PT-3...）

### SKU排序规则
- 品番、カラー、サイズ按从小到大排序
- 从配分表中提取实际出现的SKU组合

## 文件结构

```
AutoPackage/
├── main.py                  # GUI主程序
├── excel_reader.py         # 配分表读取模块
├── data_transformer.py     # 数据转换模块
├── template_writer.py      # 模板写入模块
├── config.py              # 配置文件
├── requirements.txt        # Python依赖
├── template.xls           # 箱設定模板文件
├── README.md              # 使用说明
└── analyze_excel.py       # Excel分析工具（可选）
```

## 输出文件格式

生成的文件包含以下内容（.xlsx格式）：

### 商品一覧页
- 所有SKU的列表（品番、カラー、サイズ）
- 按排序规则自动排序
- 包含管理No

### PT页（多个）
- 每个PT页代表一种配比模式
- **表头合并单元格**：管理No、パターン、枚数、納期区域真正合并
- SKU序列（行1-4，完美格式）
- 店铺箱子数据（No、タイプ、コード、店舗名、CTN_NO、各SKU数量、合計）
- 所有样式完美保留（背景色、边框、字体）

## 常见问题

### Q: 程序无法启动？
A: 确保已安装Python 3.7+，并运行了 `pip install -r requirements.txt`

### Q: 转换失败？
A: 检查：
- 配分表文件格式是否正确（.xls格式）
- 模板文件是否存在
- 输出路径是否有写入权限

### Q: 生成的PT数量不对？
A: 检查配分表中的数据，确认不同店铺的配比是否确实不同

### Q: SKU顺序不对？
A: SKU会自动按品番、カラー、サイズ排序，这是程序设计的行为

## 技术支持

如遇问题，请检查日志输出窗口中的详细信息。

## 版本历史

- **v1.0.0** (2025-12-06)
  - 初始版本
  - 支持配分表到箱設定的自动转换
  - GUI界面
  - PT自动分组
  - SKU自动排序
