# 版本更新日志

## v2.0.1 (2025-12-07 22:33) 🎨 样式完善

### 🎨 SKU列样式优化

**问题修复**：
- ✅ 修复超出模板列数的SKU列缺少灰色背景的问题
- ✅ 确保所有SKU列（无论数量多少）都有统一样式

**改进内容**：
- 表头行（1-4）：所有SKU列灰色背景 + 边框
- 数据行（5+）：所有SKU列灰色背景 + 边框
- 不再依赖模板列数限制

**技术改进**：
```python
# 定义统一的SKU列样式
header_sku_style = {
    'fill': PatternFill(start_color='D3D3D3', ...),  # 灰色
    'border': Border(...),  # 完整边框
}
# 应用到所有SKU列
for idx in range(len(skus)):
    cell.fill = header_sku_style['fill']
    cell.border = header_sku_style['border']
```

**文件大小优化**：
- 从 99KB → 86KB（优化约13%）

---

## v2.0.0 (2025-12-06 22:42) 🎉 重大升级

### 🚀 升级到openpyxl - 真正的合并单元格支持

**重大变更**：
- ✅ 完全重写为使用 `openpyxl` 库
- ✅ **真正的Excel合并单元格** - 完美实现！
- ✅ 文件格式从 `.xls` 升级到 `.xlsx`
- ✅ 更好的样式复制和保留

**新功能**：
- 🎯 表头区域真正合并单元格（A1:D1, A2:D2, A3:D3, A4:D4）
- 🎯 管理No、パターン、枚数、納期显示完美
- 🎯 样式100%保留（背景色、边框、字体、对齐）
- 🎯 支持现代Excel格式（.xlsx）

**修改文件**：
- `requirements.txt` - 移除 xlwt/xlutils，添加 openpyxl
- `template_writer.py` - 完全重写，使用openpyxl API
- `config.py` - 更新文件扩展名为 .xlsx
- `main.py` - 更新文件对话框支持 .xlsx
- `test_conversion.py` - 更新测试使用 .xlsx

**新增工具**：
- `convert_template.py` - 模板转换工具（.xls → .xlsx）
- `template.xlsx` - 新的xlsx格式模板

**技术亮点**：
- 使用 `sheet.merge_cells()` 实现真正的合并
- 使用 `copy()` 函数完美复制单元格样式
- 使用 `workbook.copy_worksheet()` 复制模板sheet
- 更现代的Excel文件格式

**输出文件**：
- 格式：`.xlsx` (Excel 2007+)
- 大小：约 86KB（压缩格式，比.xls更小）
- 兼容性：所有现代Excel版本

---

## v1.2.0 (2025-12-06 22:16)

### ✨ 元数据提取和写入

**更新内容**：
- ✅ 从配分表提取管理No（15305078）
- ✅ 从配分表提取店着日（2025/11/12）
- ✅ 管理No写入目标文件对应位置
- ✅ 店着日写入到納期位置

**数据映射**：
- 配分表行3列34 → 管理No → 目标文件各PT页
- 配分表行5列34 → 店着日 → 納期位置

---

## v1.1.0 (2025-12-06 21:45)

### 🎨 样式保留功能

**更新内容**：
- ✅ 保留模板的单元格样式
- ✅ 黄色和灰色底纹
- ✅ 边框样式
- ✅ 字体和对齐方式

---

## v1.0.0 (2025-12-06 18:56)

### 初始版本

**核心功能**：
- ✅ 配分表自动转换
- ✅ PT智能分组
- ✅ SKU自动排序
- ✅ GUI界面操作
- ✅ 实时日志输出
